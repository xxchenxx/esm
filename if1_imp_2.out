start unstructured pruning for all conv layers
Pruning encoder.layers.0.self_attn.k_proj
Pruning encoder.layers.0.self_attn.v_proj
Pruning encoder.layers.0.self_attn.q_proj
Pruning encoder.layers.0.self_attn.out_proj
Pruning encoder.layers.1.self_attn.k_proj
Pruning encoder.layers.1.self_attn.v_proj
Pruning encoder.layers.1.self_attn.q_proj
Pruning encoder.layers.1.self_attn.out_proj
Pruning encoder.layers.2.self_attn.k_proj
Pruning encoder.layers.2.self_attn.v_proj
Pruning encoder.layers.2.self_attn.q_proj
Pruning encoder.layers.2.self_attn.out_proj
Pruning encoder.layers.3.self_attn.k_proj
Pruning encoder.layers.3.self_attn.v_proj
Pruning encoder.layers.3.self_attn.q_proj
Pruning encoder.layers.3.self_attn.out_proj
Pruning encoder.layers.4.self_attn.k_proj
Pruning encoder.layers.4.self_attn.v_proj
Pruning encoder.layers.4.self_attn.q_proj
Pruning encoder.layers.4.self_attn.out_proj
Pruning encoder.layers.5.self_attn.k_proj
Pruning encoder.layers.5.self_attn.v_proj
Pruning encoder.layers.5.self_attn.q_proj
Pruning encoder.layers.5.self_attn.out_proj
Pruning encoder.layers.6.self_attn.k_proj
Pruning encoder.layers.6.self_attn.v_proj
Pruning encoder.layers.6.self_attn.q_proj
Pruning encoder.layers.6.self_attn.out_proj
Pruning encoder.layers.7.self_attn.k_proj
Pruning encoder.layers.7.self_attn.v_proj
Pruning encoder.layers.7.self_attn.q_proj
Pruning encoder.layers.7.self_attn.out_proj
tensor(0.6667, device='cuda:0')
tensor(0.7292, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.6316, device='cuda:0')
tensor(0.3333, device='cuda:0')
ACC: tensor(0.5962, device='cuda:0')
tensor(0.6140, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.2500, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.4135, device='cuda:0')
tensor(0.4800, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5417, device='cuda:0')
tensor(0.2857, device='cuda:0')
tensor(0.8947, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5192, device='cuda:0')
tensor(0.6047, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.3214, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5577, device='cuda:0')
tensor(0.6122, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5417, device='cuda:0')
tensor(0.4643, device='cuda:0')
tensor(0.6842, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.5532, device='cuda:0')
tensor(0.3333, device='cuda:0')
tensor(0.8542, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.5789, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6154, device='cuda:0')
tensor(0.5942, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.5833, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5673, device='cuda:0')
tensor(0.6512, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0.3333, device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.5854, device='cuda:0')
BEST_ACC: 0.6153846383094788
start unstructured pruning for all conv layers
Pruning encoder.layers.0.self_attn.k_proj
Pruning encoder.layers.0.self_attn.v_proj
Pruning encoder.layers.0.self_attn.q_proj
Pruning encoder.layers.0.self_attn.out_proj
Pruning encoder.layers.1.self_attn.k_proj
Pruning encoder.layers.1.self_attn.v_proj
Pruning encoder.layers.1.self_attn.q_proj
Pruning encoder.layers.1.self_attn.out_proj
Pruning encoder.layers.2.self_attn.k_proj
Pruning encoder.layers.2.self_attn.v_proj
Pruning encoder.layers.2.self_attn.q_proj
Pruning encoder.layers.2.self_attn.out_proj
Pruning encoder.layers.3.self_attn.k_proj
Pruning encoder.layers.3.self_attn.v_proj
Pruning encoder.layers.3.self_attn.q_proj
Pruning encoder.layers.3.self_attn.out_proj
Pruning encoder.layers.4.self_attn.k_proj
Pruning encoder.layers.4.self_attn.v_proj
Pruning encoder.layers.4.self_attn.q_proj
Pruning encoder.layers.4.self_attn.out_proj
Pruning encoder.layers.5.self_attn.k_proj
Pruning encoder.layers.5.self_attn.v_proj
Pruning encoder.layers.5.self_attn.q_proj
Pruning encoder.layers.5.self_attn.out_proj
Pruning encoder.layers.6.self_attn.k_proj
Pruning encoder.layers.6.self_attn.v_proj
Pruning encoder.layers.6.self_attn.q_proj
Pruning encoder.layers.6.self_attn.out_proj
Pruning encoder.layers.7.self_attn.k_proj
Pruning encoder.layers.7.self_attn.v_proj
Pruning encoder.layers.7.self_attn.q_proj
Pruning encoder.layers.7.self_attn.out_proj
tensor(0.6667, device='cuda:0')
tensor(0.7083, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6154, device='cuda:0')
tensor(0.6538, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7292, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6250, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.4583, device='cuda:0')
tensor(0.5714, device='cuda:0')
tensor(0.6842, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.5789, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.3214, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5577, device='cuda:0')
tensor(0.6122, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5865, device='cuda:0')
tensor(0.6383, device='cuda:0')
tensor(0.3333, device='cuda:0')
tensor(0.8125, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.6316, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6154, device='cuda:0')
tensor(0.6290, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.6042, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5673, device='cuda:0')
tensor(0.6170, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5865, device='cuda:0')
tensor(0.6531, device='cuda:0')
BEST_ACC: 0.625
start unstructured pruning for all conv layers
Pruning encoder.layers.0.self_attn.k_proj
Pruning encoder.layers.0.self_attn.v_proj
Pruning encoder.layers.0.self_attn.q_proj
Pruning encoder.layers.0.self_attn.out_proj
Pruning encoder.layers.1.self_attn.k_proj
Pruning encoder.layers.1.self_attn.v_proj
Pruning encoder.layers.1.self_attn.q_proj
Pruning encoder.layers.1.self_attn.out_proj
Pruning encoder.layers.2.self_attn.k_proj
Pruning encoder.layers.2.self_attn.v_proj
Pruning encoder.layers.2.self_attn.q_proj
Pruning encoder.layers.2.self_attn.out_proj
Pruning encoder.layers.3.self_attn.k_proj
Pruning encoder.layers.3.self_attn.v_proj
Pruning encoder.layers.3.self_attn.q_proj
Pruning encoder.layers.3.self_attn.out_proj
Pruning encoder.layers.4.self_attn.k_proj
Pruning encoder.layers.4.self_attn.v_proj
Pruning encoder.layers.4.self_attn.q_proj
Pruning encoder.layers.4.self_attn.out_proj
Pruning encoder.layers.5.self_attn.k_proj
Pruning encoder.layers.5.self_attn.v_proj
Pruning encoder.layers.5.self_attn.q_proj
Pruning encoder.layers.5.self_attn.out_proj
Pruning encoder.layers.6.self_attn.k_proj
Pruning encoder.layers.6.self_attn.v_proj
Pruning encoder.layers.6.self_attn.q_proj
Pruning encoder.layers.6.self_attn.out_proj
Pruning encoder.layers.7.self_attn.k_proj
Pruning encoder.layers.7.self_attn.v_proj
Pruning encoder.layers.7.self_attn.q_proj
Pruning encoder.layers.7.self_attn.out_proj
tensor(0.8333, device='cuda:0')
tensor(0.6458, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6842, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6058, device='cuda:0')
tensor(0.6596, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.4583, device='cuda:0')
tensor(0.3214, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0.3333, device='cuda:0')
ACC: tensor(0.5000, device='cuda:0')
tensor(0.5946, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7708, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6346, device='cuda:0')
tensor(0.6379, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7500, device='cuda:0')
tensor(0.2143, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5865, device='cuda:0')
tensor(0.6000, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7500, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6154, device='cuda:0')
tensor(0.6102, device='cuda:0')
tensor(0.8333, device='cuda:0')
tensor(0.7292, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.5789, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5962, device='cuda:0')
tensor(0.6034, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.6042, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5865, device='cuda:0')
tensor(0.6744, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.6042, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5673, device='cuda:0')
tensor(0.6591, device='cuda:0')
BEST_ACC: 0.634615421295166
start unstructured pruning for all conv layers
Pruning encoder.layers.0.self_attn.k_proj
Pruning encoder.layers.0.self_attn.v_proj
Pruning encoder.layers.0.self_attn.q_proj
Pruning encoder.layers.0.self_attn.out_proj
Pruning encoder.layers.1.self_attn.k_proj
Pruning encoder.layers.1.self_attn.v_proj
Pruning encoder.layers.1.self_attn.q_proj
Pruning encoder.layers.1.self_attn.out_proj
Pruning encoder.layers.2.self_attn.k_proj
Pruning encoder.layers.2.self_attn.v_proj
Pruning encoder.layers.2.self_attn.q_proj
Pruning encoder.layers.2.self_attn.out_proj
Pruning encoder.layers.3.self_attn.k_proj
Pruning encoder.layers.3.self_attn.v_proj
Pruning encoder.layers.3.self_attn.q_proj
Pruning encoder.layers.3.self_attn.out_proj
Pruning encoder.layers.4.self_attn.k_proj
Pruning encoder.layers.4.self_attn.v_proj
Pruning encoder.layers.4.self_attn.q_proj
Pruning encoder.layers.4.self_attn.out_proj
Pruning encoder.layers.5.self_attn.k_proj
Pruning encoder.layers.5.self_attn.v_proj
Pruning encoder.layers.5.self_attn.q_proj
Pruning encoder.layers.5.self_attn.out_proj
Pruning encoder.layers.6.self_attn.k_proj
Pruning encoder.layers.6.self_attn.v_proj
Pruning encoder.layers.6.self_attn.q_proj
Pruning encoder.layers.6.self_attn.out_proj
Pruning encoder.layers.7.self_attn.k_proj
Pruning encoder.layers.7.self_attn.v_proj
Pruning encoder.layers.7.self_attn.q_proj
Pruning encoder.layers.7.self_attn.out_proj
tensor(0.6667, device='cuda:0')
tensor(0.6875, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.6842, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5769, device='cuda:0')
tensor(0.6346, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.7500, device='cuda:0')
tensor(0.2857, device='cuda:0')
tensor(0.8947, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6250, device='cuda:0')
tensor(0.6207, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.3958, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.8947, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.4712, device='cuda:0')
tensor(0.5588, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5673, device='cuda:0')
tensor(0.6522, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.9375, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.6842, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6923, device='cuda:0')
tensor(0.6716, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7708, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6250, device='cuda:0')
tensor(0.6379, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5208, device='cuda:0')
tensor(0.4643, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.6579, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.4583, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5000, device='cuda:0')
tensor(0.6286, device='cuda:0')
BEST_ACC: 0.692307710647583
start unstructured pruning for all conv layers
Pruning encoder.layers.0.self_attn.k_proj
Pruning encoder.layers.0.self_attn.v_proj
Pruning encoder.layers.0.self_attn.q_proj
Pruning encoder.layers.0.self_attn.out_proj
Pruning encoder.layers.1.self_attn.k_proj
Pruning encoder.layers.1.self_attn.v_proj
Pruning encoder.layers.1.self_attn.q_proj
Pruning encoder.layers.1.self_attn.out_proj
Pruning encoder.layers.2.self_attn.k_proj
Pruning encoder.layers.2.self_attn.v_proj
Pruning encoder.layers.2.self_attn.q_proj
Pruning encoder.layers.2.self_attn.out_proj
Pruning encoder.layers.3.self_attn.k_proj
Pruning encoder.layers.3.self_attn.v_proj
Pruning encoder.layers.3.self_attn.q_proj
Pruning encoder.layers.3.self_attn.out_proj
Pruning encoder.layers.4.self_attn.k_proj
Pruning encoder.layers.4.self_attn.v_proj
Pruning encoder.layers.4.self_attn.q_proj
Pruning encoder.layers.4.self_attn.out_proj
Pruning encoder.layers.5.self_attn.k_proj
Pruning encoder.layers.5.self_attn.v_proj
Pruning encoder.layers.5.self_attn.q_proj
Pruning encoder.layers.5.self_attn.out_proj
Pruning encoder.layers.6.self_attn.k_proj
Pruning encoder.layers.6.self_attn.v_proj
Pruning encoder.layers.6.self_attn.q_proj
Pruning encoder.layers.6.self_attn.out_proj
Pruning encoder.layers.7.self_attn.k_proj
Pruning encoder.layers.7.self_attn.v_proj
Pruning encoder.layers.7.self_attn.q_proj
Pruning encoder.layers.7.self_attn.out_proj
tensor(0.5000, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5769, device='cuda:0')
tensor(0.6531, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.4792, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.6571, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.3750, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.4712, device='cuda:0')
tensor(0.6000, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5625, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.8947, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5577, device='cuda:0')
tensor(0.6429, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.7083, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6346, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6875, device='cuda:0')
tensor(0.4643, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6058, device='cuda:0')
tensor(0.6471, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5208, device='cuda:0')
tensor(0.4643, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5385, device='cuda:0')
tensor(0.6757, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.6486, device='cuda:0')
BEST_ACC: 0.634615421295166
start unstructured pruning for all conv layers
Pruning encoder.layers.0.self_attn.k_proj
Pruning encoder.layers.0.self_attn.v_proj
Pruning encoder.layers.0.self_attn.q_proj
Pruning encoder.layers.0.self_attn.out_proj
Pruning encoder.layers.1.self_attn.k_proj
Pruning encoder.layers.1.self_attn.v_proj
Pruning encoder.layers.1.self_attn.q_proj
Pruning encoder.layers.1.self_attn.out_proj
Pruning encoder.layers.2.self_attn.k_proj
Pruning encoder.layers.2.self_attn.v_proj
Pruning encoder.layers.2.self_attn.q_proj
Pruning encoder.layers.2.self_attn.out_proj
Pruning encoder.layers.3.self_attn.k_proj
Pruning encoder.layers.3.self_attn.v_proj
Pruning encoder.layers.3.self_attn.q_proj
Pruning encoder.layers.3.self_attn.out_proj
Pruning encoder.layers.4.self_attn.k_proj
Pruning encoder.layers.4.self_attn.v_proj
Pruning encoder.layers.4.self_attn.q_proj
Pruning encoder.layers.4.self_attn.out_proj
Pruning encoder.layers.5.self_attn.k_proj
Pruning encoder.layers.5.self_attn.v_proj
Pruning encoder.layers.5.self_attn.q_proj
Pruning encoder.layers.5.self_attn.out_proj
Pruning encoder.layers.6.self_attn.k_proj
Pruning encoder.layers.6.self_attn.v_proj
Pruning encoder.layers.6.self_attn.q_proj
Pruning encoder.layers.6.self_attn.out_proj
Pruning encoder.layers.7.self_attn.k_proj
Pruning encoder.layers.7.self_attn.v_proj
Pruning encoder.layers.7.self_attn.q_proj
Pruning encoder.layers.7.self_attn.out_proj
tensor(0.5000, device='cuda:0')
tensor(0.6458, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.6842, device='cuda:0')
tensor(0.3333, device='cuda:0')
ACC: tensor(0.5577, device='cuda:0')
tensor(0.6078, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.2083, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.9474, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.3942, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.1667, device='cuda:0')
tensor(0.5833, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.6829, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5208, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.6757, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6875, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.6842, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5769, device='cuda:0')
tensor(0.6226, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5673, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5625, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5481, device='cuda:0')
tensor(0.6585, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5625, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.6279, device='cuda:0')
BEST_ACC: 0.5769230723381042
start unstructured pruning for all conv layers
Pruning encoder.layers.0.self_attn.k_proj
Pruning encoder.layers.0.self_attn.v_proj
Pruning encoder.layers.0.self_attn.q_proj
Pruning encoder.layers.0.self_attn.out_proj
Pruning encoder.layers.1.self_attn.k_proj
Pruning encoder.layers.1.self_attn.v_proj
Pruning encoder.layers.1.self_attn.q_proj
Pruning encoder.layers.1.self_attn.out_proj
Pruning encoder.layers.2.self_attn.k_proj
Pruning encoder.layers.2.self_attn.v_proj
Pruning encoder.layers.2.self_attn.q_proj
Pruning encoder.layers.2.self_attn.out_proj
Pruning encoder.layers.3.self_attn.k_proj
Pruning encoder.layers.3.self_attn.v_proj
Pruning encoder.layers.3.self_attn.q_proj
Pruning encoder.layers.3.self_attn.out_proj
Pruning encoder.layers.4.self_attn.k_proj
Pruning encoder.layers.4.self_attn.v_proj
Pruning encoder.layers.4.self_attn.q_proj
Pruning encoder.layers.4.self_attn.out_proj
Pruning encoder.layers.5.self_attn.k_proj
Pruning encoder.layers.5.self_attn.v_proj
Pruning encoder.layers.5.self_attn.q_proj
Pruning encoder.layers.5.self_attn.out_proj
Pruning encoder.layers.6.self_attn.k_proj
Pruning encoder.layers.6.self_attn.v_proj
Pruning encoder.layers.6.self_attn.q_proj
Pruning encoder.layers.6.self_attn.out_proj
Pruning encoder.layers.7.self_attn.k_proj
Pruning encoder.layers.7.self_attn.v_proj
Pruning encoder.layers.7.self_attn.q_proj
Pruning encoder.layers.7.self_attn.out_proj
tensor(0.6667, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5962, device='cuda:0')
tensor(0.6531, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6875, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6058, device='cuda:0')
tensor(0.6875, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.4792, device='cuda:0')
tensor(0.1786, device='cuda:0')
tensor(0.8947, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.4615, device='cuda:0')
tensor(0.5750, device='cuda:0')
tensor(0.3333, device='cuda:0')
tensor(0.7500, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.5789, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5865, device='cuda:0')
tensor(0.6429, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5673, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5417, device='cuda:0')
tensor(0.4643, device='cuda:0')
tensor(0.6842, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5288, device='cuda:0')
tensor(0.5778, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.4643, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5962, device='cuda:0')
tensor(0.6818, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5625, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5481, device='cuda:0')
tensor(0.6136, device='cuda:0')
BEST_ACC: 0.6057692766189575
start unstructured pruning for all conv layers
Pruning encoder.layers.0.self_attn.k_proj
Pruning encoder.layers.0.self_attn.v_proj
Pruning encoder.layers.0.self_attn.q_proj
Pruning encoder.layers.0.self_attn.out_proj
Pruning encoder.layers.1.self_attn.k_proj
Pruning encoder.layers.1.self_attn.v_proj
Pruning encoder.layers.1.self_attn.q_proj
Pruning encoder.layers.1.self_attn.out_proj
Pruning encoder.layers.2.self_attn.k_proj
Pruning encoder.layers.2.self_attn.v_proj
Pruning encoder.layers.2.self_attn.q_proj
Pruning encoder.layers.2.self_attn.out_proj
Pruning encoder.layers.3.self_attn.k_proj
Pruning encoder.layers.3.self_attn.v_proj
Pruning encoder.layers.3.self_attn.q_proj
Pruning encoder.layers.3.self_attn.out_proj
Pruning encoder.layers.4.self_attn.k_proj
Pruning encoder.layers.4.self_attn.v_proj
Pruning encoder.layers.4.self_attn.q_proj
Pruning encoder.layers.4.self_attn.out_proj
Pruning encoder.layers.5.self_attn.k_proj
Pruning encoder.layers.5.self_attn.v_proj
Pruning encoder.layers.5.self_attn.q_proj
Pruning encoder.layers.5.self_attn.out_proj
Pruning encoder.layers.6.self_attn.k_proj
Pruning encoder.layers.6.self_attn.v_proj
Pruning encoder.layers.6.self_attn.q_proj
Pruning encoder.layers.6.self_attn.out_proj
Pruning encoder.layers.7.self_attn.k_proj
Pruning encoder.layers.7.self_attn.v_proj
Pruning encoder.layers.7.self_attn.q_proj
Pruning encoder.layers.7.self_attn.out_proj
tensor(0.5000, device='cuda:0')
tensor(0.6250, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5769, device='cuda:0')
tensor(0.6383, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6042, device='cuda:0')
tensor(0.3214, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5385, device='cuda:0')
tensor(0.6591, device='cuda:0')
tensor(0.3333, device='cuda:0')
tensor(0.4375, device='cuda:0')
tensor(0.2857, device='cuda:0')/home/xc4863/esm/esm/pretrained.py:173: UserWarning: Regression weights not found, predicting contacts will not produce correct results.
  "Regression weights not found, predicting contacts will not produce correct results."
/home/xc4863/esm/esm/inverse_folding/util.py:243: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  for cd, _ in coords_and_confidence

tensor(0.9474, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.4712, device='cuda:0')
tensor(0.6562, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.3571, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5096, device='cuda:0')
tensor(0.6316, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7917, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.6346, device='cuda:0')
tensor(0.6333, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6458, device='cuda:0')
tensor(0.4643, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5962, device='cuda:0')
tensor(0.6327, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5625, device='cuda:0')
tensor(0.4643, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5577, device='cuda:0')
tensor(0.6585, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6042, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5673, device='cuda:0')
tensor(0.6444, device='cuda:0')
BEST_ACC: 0.634615421295166
start unstructured pruning for all conv layers
Pruning encoder.layers.0.self_attn.k_proj
Pruning encoder.layers.0.self_attn.v_proj
Pruning encoder.layers.0.self_attn.q_proj
Pruning encoder.layers.0.self_attn.out_proj
Pruning encoder.layers.1.self_attn.k_proj
Pruning encoder.layers.1.self_attn.v_proj
Pruning encoder.layers.1.self_attn.q_proj
Pruning encoder.layers.1.self_attn.out_proj
Pruning encoder.layers.2.self_attn.k_proj
Pruning encoder.layers.2.self_attn.v_proj
Pruning encoder.layers.2.self_attn.q_proj
Pruning encoder.layers.2.self_attn.out_proj
Pruning encoder.layers.3.self_attn.k_proj
Pruning encoder.layers.3.self_attn.v_proj
Pruning encoder.layers.3.self_attn.q_proj
Pruning encoder.layers.3.self_attn.out_proj
Pruning encoder.layers.4.self_attn.k_proj
Pruning encoder.layers.4.self_attn.v_proj
Pruning encoder.layers.4.self_attn.q_proj
Pruning encoder.layers.4.self_attn.out_proj
Pruning encoder.layers.5.self_attn.k_proj
Pruning encoder.layers.5.self_attn.v_proj
Pruning encoder.layers.5.self_attn.q_proj
Pruning encoder.layers.5.self_attn.out_proj
Pruning encoder.layers.6.self_attn.k_proj
Pruning encoder.layers.6.self_attn.v_proj
Pruning encoder.layers.6.self_attn.q_proj
Pruning encoder.layers.6.self_attn.out_proj
Pruning encoder.layers.7.self_attn.k_proj
Pruning encoder.layers.7.self_attn.v_proj
Pruning encoder.layers.7.self_attn.q_proj
Pruning encoder.layers.7.self_attn.out_proj
tensor(0.5000, device='cuda:0')
tensor(0.6042, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.6842, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5481, device='cuda:0')
tensor(0.5800, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5192, device='cuda:0')
tensor(0.6486, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6458, device='cuda:0')
tensor(0.2143, device='cuda:0')
tensor(0.8947, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5481, device='cuda:0')
tensor(0.6078, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6458, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.8421, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5865, device='cuda:0')
tensor(0.6200, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.5833, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5769, device='cuda:0')
tensor(0.6222, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.7083, device='cuda:0')
tensor(0.3929, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5962, device='cuda:0')
tensor(0.6071, device='cuda:0')
tensor(0.5000, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7895, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5962, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.6667, device='cuda:0')
tensor(0.4286, device='cuda:0')
tensor(0.7368, device='cuda:0')
tensor(0., device='cuda:0')
ACC: tensor(0.5962, device='cuda:0')
tensor(0.6154, device='cuda:0')
BEST_ACC: 0.5961538553237915
